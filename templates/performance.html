<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Performance Tracker</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='performance_styles.css') }}">
</head>
<body>
    <h1>Performance Tracker</h1>

    <!-- Form to input new courses -->
    <form action="/performance" method="POST">
        <label for="semester">Select Semester:</label>
        <select name="semester" id="semester">
            <option value="1">Semester 1</option>
            <option value="2">Semester 2</option>
            <option value="3">Semester 3</option>
            <option value="4">Semester 4</option>
            <option value="5">Semester 5</option>
            <option value="6">Semester 6</option>
            <option value="7">Semester 7</option>
            <option value="8">Semester 8</option>
        </select>

        <label for="num_courses">Number of Courses:</label>
        <input type="number" name="num_courses" id="num_courses" min="1" max="10" required>

        <div id="course_inputs"></div>

        <button type="submit">Submit</button>
    </form>

    <!-- Table displaying previously added semesters and courses -->
    <h2>Previously Added Courses</h2>
    {% if semesters %}
    <table>
        <thead>
            <tr>
                <th>Semester</th>
                <th>CGPA</th>
                <th>Course Name</th>
                <th>Course Code</th>
                <th>Credits</th>
                <th>Grade</th>
                <th>Attendance</th>
            </tr>
        </thead>
        <tbody>
            {% for semester in semesters %}
                <!-- Display semester details -->
                <tr>
                    <td rowspan="{{ semester.courses|length + 1 }}">{{ semester.semester }}</td>
                    <td rowspan="{{ semester.courses|length + 1 }}">{{ semester.cgpa }}</td>
                </tr>
                <!-- Display each course under the semester -->
                {% for course in semester.courses %}
                <tr>
                    <td>{{ course.course_name }}</td>
                    <td>{{ course.course_code }}</td>
                    <td>{{ course.credit_hours }}</td>
                    <td>{{ course.grade }}</td>
                    <td>{{ course.attendance }}</td>
                </tr>
                {% endfor %}
            {% endfor %}
        </tbody>
    </table>
    {% else %}
    <p>No courses added yet.</p>
    {% endif %}

    <script>
        // Dynamically add course input fields based on the number entered
        document.getElementById('num_courses').addEventListener('input', function() {
            const numCourses = parseInt(this.value);
            const courseInputs = document.getElementById('course_inputs');
            courseInputs.innerHTML = '';  // Clear existing inputs

            for (let i = 0; i < numCourses; i++) {
                courseInputs.innerHTML += `
                    <div>
                        <h3>Course ${i + 1}</h3>
                        <label for="course_name_${i}">Course Name:</label>
                        <input type="text" name="course_name_${i}" required><br>

                        <label for="course_code_${i}">Course Code:</label>
                        <input type="text" name="course_code_${i}" required><br>

                        <label for="credit_hours_${i}">Credit Hours:</label>
                        <input type="number" name="credit_hours_${i}" required><br>

                        <label for="grade_${i}">Grade:</label>
                        <select name="grade_${i}" required>
                            <option value="O">O</option>
                            <option value="A+">A+</option>
                            <option value="A">A</option>
                            <option value="B+">B+</option>
                            <option value="B">B</option>
                            <option value="C">C</option>
                        </select><br>

                        <label for="attendance_${i}">Attendance (%):</label>
                        <input type="number" name="attendance_${i}" required><br>
                    </div>
                `;
            }
        });
    </script>
</body>
</html>
